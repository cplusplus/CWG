<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
<TITLE>
    CWG Issue 2304</TITLE>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<STYLE TYPE="text/css">
  INS { text-decoration:none; font-weight:bold; background-color:#A0FFA0 }
  .INS { text-decoration:none; background-color:#D0FFD0 }
  DEL { text-decoration:line-through; background-color:#FFA0A0 }
  .DEL { text-decoration:line-through; background-color: #FFD0D0 }
  @media (prefers-color-scheme: dark) {
    HTML { background-color:#202020; color:#f0f0f0; }
    A { color:#5bc0ff; }
    A:visited { color:#c6a8ff; }
    A:hover, a:focus { color:#afd7ff; }
    INS { background-color:#033a16; color:#aff5b4; }
    .INS { background-color: #033a16; }
    DEL { background-color:#67060c; color:#ffdcd7; }
    .DEL { background-color:#67060c; }
  }
  SPAN.cmnt { font-family:Times; font-style:italic }
</STYLE>
</HEAD>
<BODY>
<P><EM>This is an unofficial snapshot of the ISO/IEC JTC1 SC22 WG21
  Core Issues List revision 116c.
  See http://www.open-std.org/jtc1/sc22/wg21/ for the official
  list.</EM></P>
<P>2025-03-08</P>
<HR>
<A NAME="2304"></A><H4>2304.
  
Incomplete type vs overload resolution
</H4>
<B>Section: </B>12.2.4.2&#160; [<A href="https://wg21.link/over.best.ics">over.best.ics</A>]
 &#160;&#160;&#160;

 <B>Status: </B>NAD
 &#160;&#160;&#160;

 <B>Submitter: </B>John Spicer
 &#160;&#160;&#160;

 <B>Date: </B>2016-07-05<BR>


<P>It is not clear whether the current treatment of an example like
the following is what we want:</P>

<PRE>
  template&lt;typename T&gt; void foo(T, int);
  template&lt;typename T&gt; void foo(T&amp;, ...);
  struct Q;
  void fn1(Q &amp;data_vectors) { foo(data_vectors, 0); }
</PRE>

<P>According to 12.2.4.2 [<A href="https://wg21.link/over.best.ics#8">over.best.ics</A>] paragraph 8,</P>

<BLOCKQUOTE>

If no conversions are required to match an argument to a parameter type,
the implicit conversion sequence is the standard conversion sequence
consisting of the identity conversion (12.2.4.2.2 [<A href="https://wg21.link/over.ics.scs">over.ics.scs</A>]).

</BLOCKQUOTE>

<P>This would select the first overload and then fail in attempting
to call it because of the incomplete type. On the other hand, it is
ill-formed to define or call a function with an incomplete parameter
type, although it can be declared, so it might be reasonable to take
completeness of the parameter type into consideration for SFINAE
purposes. 13.10.3 [<A href="https://wg21.link/temp.deduct#8.11">temp.deduct</A>] bullet 8.11 says,</P>

<BLOCKQUOTE>

<P>[<I>Note:</I> Type deduction may fail for the following reasons:</P>

<UL>
<LI><P>...</P></LI>

<LI><P>Attempting to create a function type in which a parameter type or
the return type is an abstract class type
(11.7.4 [<A href="https://wg21.link/class.abstract">class.abstract</A>]).</P></LI>

</UL>

</BLOCKQUOTE>

<P>If a definition of <TT>Q</TT> were available, we would need to
instantiate it to see if it is abstract.</P>

<P>It would seem reasonable for an incomplete type to be invalid as
well. That would be consistent with the other rules and general desire
not to select functions you can't call based on the template argument
types.</P>

<P><B>Rationale (July, 2017):</B></P>

<P>CWG determined that no change was needed.</P>

<BR><BR>
</BODY>
</HTML>
