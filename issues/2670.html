<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
<TITLE>
    CWG Issue 2670</TITLE>
<STYLE TYPE="text/css">
  INS { text-decoration:none; font-weight:bold; background-color:#A0FFA0 }
  .INS { text-decoration:none; background-color:#D0FFD0 }
  DEL { text-decoration:line-through; background-color:#FFA0A0 }
  .DEL { text-decoration:line-through; background-color: #FFD0D0 }
  SPAN.cmnt { font-family:Times; font-style:italic }
</STYLE>
</HEAD>
<BODY>
<P><EM>This is an unofficial snapshot of the ISO/IEC JTC1 SC22 WG21
  Core Issues List revision 116b.
  See http://www.open-std.org/jtc1/sc22/wg21/ for the official
  list.</EM></P>
<P>2025-03-05</P>
<HR>
<A NAME="2670"></A><H4>2670.
  
Programs and translation units
</H4>
<B>Section: </B>6.6&#160; [<A href="https://wg21.link/basic.link">basic.link</A>]
 &#160;&#160;&#160;

 <B>Status: </B>open
 &#160;&#160;&#160;

 <B>Submitter: </B>Gabriel dos Reis
 &#160;&#160;&#160;

 <B>Date: </B>2022-12-21<BR>




<P>Subclause 6.6 [<A href="https://wg21.link/basic.link#1">basic.link</A>] paragraph 1 specifies:</P>

<BLOCKQUOTE>

A <I>program</I> consists of one or more translation units
(5.1 [<A href="https://wg21.link/lex.separate">lex.separate</A>]) linked together. A translation unit
consists of a sequence of declarations.

</BLOCKQUOTE>

<P>Subclause 5.1 [<A href="https://wg21.link/lex.separate#1">lex.separate</A>] paragraph 1 defines "translation unit":</P>

<BLOCKQUOTE>

A source file together with all the headers
(16.4.2.3 [<A href="https://wg21.link/headers">headers</A>]) and source files included
(15.3 [<A href="https://wg21.link/cpp.include">cpp.include</A>]) via the preprocessing directive #include,
less any source lines skipped by any of the conditional inclusion
(15.2 [<A href="https://wg21.link/cpp.cond">cpp.cond</A>]) preprocessing directives, is called a
<I>translation unit</I>.

</BLOCKQUOTE>

<P>Subclause 5.2 [<A href="https://wg21.link/lex.phases#7">lex.phases</A>] paragraph 7 first mentions the "translation" of translation units:</P>

<BLOCKQUOTE>

Whitespace characters separating tokens are no longer
significant. Each preprocessing token is converted into a token
(5.10 [<A href="https://wg21.link/lex.token">lex.token</A>]). The resulting tokens are syntactically and
semantically analyzed and translated as a translation unit.

</BLOCKQUOTE>

<P>However, 5.2 [<A href="https://wg21.link/lex.phases#8">lex.phases</A>] paragraph 8 introduces
"instantiation units" and 5.2 [<A href="https://wg21.link/lex.phases#9">lex.phases</A>] paragraph 9
specifies:</P>

<BLOCKQUOTE>

Translated translation units and instantiation units are combined as
follows:

</BLOCKQUOTE>

<P>and 5.2 [<A href="https://wg21.link/lex.phases#9">lex.phases</A>] paragraph 9 specifies:</P>

<BLOCKQUOTE>

All external entity references are resolved. Library components are
linked to satisfy external references to entities not defined in the
current translation. All such translator output is collected into a
program image which contains information needed for execution in its
execution environment.

</BLOCKQUOTE>

<P>The term "linking" in 5.2 [<A href="https://wg21.link/lex.phases">lex.phases</A>] comes after
translated translation units and instantiation units are combined, yet
6.6 [<A href="https://wg21.link/basic.link#1">basic.link</A>] paragraph 1 states that (untranslated)
translation units are linked to form a program.  That seems
inconsistent.</P>

<P><B>Additional notes (February, 2023)</B></P>

<P>See also <A HREF="2518.html">issue 2518</A>, which introduced
the term "preprocessing translation unit" to remove the conflict
between 6.6 [<A href="https://wg21.link/basic.link#1">basic.link</A>] paragraph 1 and 5.1 [<A href="https://wg21.link/lex.separate#1">lex.separate</A>] paragraph 1.</P>

<BR><BR>
</BODY>
</HTML>
