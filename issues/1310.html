<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
<TITLE>
    CWG Issue 1310</TITLE>
<STYLE TYPE="text/css">
  INS { text-decoration:none; font-weight:bold; background-color:#A0FFA0 }
  .INS { text-decoration:none; background-color:#D0FFD0 }
  DEL { text-decoration:line-through; background-color:#FFA0A0 }
  .DEL { text-decoration:line-through; background-color: #FFD0D0 }
  SPAN.cmnt { font-family:Times; font-style:italic }
</STYLE>
</HEAD>
<BODY>
<P><EM>This is an unofficial snapshot of the ISO/IEC JTC1 SC22 WG21
  Core Issues List revision 116a.
  See http://www.open-std.org/jtc1/sc22/wg21/ for the official
  list.</EM></P>
<P>2024-12-19</P>
<HR>
<A NAME="1310"></A><H4>1310.
  
What is an &#8220;acceptable lookup result?&#8221;
</H4>
<B>Section: </B>6.5.5.2&#160; [<A href="https://wg21.link/class.qual">class.qual</A>]
 &#160;&#160;&#160;

 <B>Status: </B>CD3
 &#160;&#160;&#160;

 <B>Submitter: </B>Jason Merrill
 &#160;&#160;&#160;

 <B>Date: </B>2011-05-06<BR>


<P>[Moved to DR at the April, 2013 meeting.]</P>



<P>In 6.5.5.2 [<A href="https://wg21.link/class.qual#2">class.qual</A>] paragraph 2,</P>

<BLOCKQUOTE>

<P>In a lookup in which the constructor is an acceptable lookup result
and the <I>nested-name-specifier</I> nominates a class <TT>C</TT>:</P>

<UL>

<LI><P>if the name specified after the <I>nested-name-specifier</I>, when
looked up in <TT>C</TT>, is the injected-class-name of <TT>C</TT>
(Clause 11 [<A href="https://wg21.link/class">class</A>]), or
</P></LI>

<LI><P>in a <I>using-declaration</I> (9.9 [<A href="https://wg21.link/namespace.udecl">namespace.udecl</A>]) that is a
<I>member-declaration</I>, if the name specified after the
<I>nested-name-specifier</I> is the same as the <I>identifier</I> or
the <I>simple-template-id</I>'s <I>template-name</I> in the last
component of the <I>nested-name-specifier</I>,
</P></LI>

</UL>

<P>the name is instead considered to name the constructor of class
<TT>C</TT>.
</P>

</BLOCKQUOTE>

<P>it is not clear what constitutes &#8220;an acceptable lookup
result.&#8221;  For instance, is</P>

<PRE>
  struct S { } *sp = new S::S;
</PRE>

<P>well-formed?</P>

<P>The intent of the wording was that <TT>S::S</TT> would refer to
the constructor except in lookups that ignore the names of functions,
e.g., in <I>elaborated-type-specifier</I>s and
<I>nested-name-specifier</I>s.  There doesn't seem to be a good reason
to allow a <I>qualified-id</I> naming the injected-class-name.  The
alternative, i.e., only to find the constructor in a declarator,
complicates parsing because the determination of whether the name is
a type or a function would require lookahead.</P>

<P><B>Proposed resolution (August, 2012):</B></P>

<P>Change 6.5.5.2 [<A href="https://wg21.link/class.qual#2">class.qual</A>] paragraph 2 as follows:</P>

<BLOCKQUOTE>

<P>In a lookup in which <DEL>the constructor is an acceptable lookup
result</DEL> <INS>function names are not ignored [<I>Footnote:</I>
Lookups in which function names are ignored include names appearing in
a <I>nested-name-specifier</I>, an <I>elaborated-type-specifier</I>,
or a <I>base-specifier</I>. &#8212;<I>end footnote</I>]</INS> and the
<I>nested-name-specifier</I> nominates a class <TT>C</TT>:</P>

<UL>
<LI>

<P>if the name specified after the <I>nested-name-specifier</I>, when
looked up in <TT>C</TT>, is the injected-class-name of C (
Clause 11 [<A href="https://wg21.link/class">class</A>]), or
</P>
</LI>

<LI>

<P>in a <I>using-declaration</I> (9.9 [<A href="https://wg21.link/namespace.udecl">namespace.udecl</A>]) that is
a <I>member-declaration</I>, if the name specified after the
<I>nested-name-specifier</I> is the same as the identifier or the
<I>simple-template-id</I>'s <I>template-name</I> in the last component
of the <I>nested-name-specifier</I>,
</P>
</LI>

</UL>

<P>the name is instead considered to name the constructor of class
<TT>C</TT>...
</P>

</BLOCKQUOTE>

<BR><BR>
</BODY>
</HTML>
