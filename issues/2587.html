<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
<TITLE>
    CWG Issue 2587</TITLE>
<STYLE TYPE="text/css">
  INS { text-decoration:none; font-weight:bold; background-color:#A0FFA0 }
  .INS { text-decoration:none; background-color:#D0FFD0 }
  DEL { text-decoration:line-through; background-color:#FFA0A0 }
  .DEL { text-decoration:line-through; background-color: #FFD0D0 }
  SPAN.cmnt { font-family:Times; font-style:italic }
</STYLE>
</HEAD>
<BODY>
<P><EM>This is an unofficial snapshot of the ISO/IEC JTC1 SC22 WG21
  Core Issues List revision 116a.
  See http://www.open-std.org/jtc1/sc22/wg21/ for the official
  list.</EM></P>
<P>2024-12-19</P>
<HR>
<A NAME="2587"></A><H4>2587.
  
Visible side effects and initial value of an object
</H4>
<B>Section: </B>6.9.2.2&#160; [<A href="https://wg21.link/intro.races">intro.races</A>]
 &#160;&#160;&#160;

 <B>Status: </B>review
 &#160;&#160;&#160;

 <B>Submitter: </B>Andrey Erokhin
 &#160;&#160;&#160;

 <B>Date: </B>2022-05-10<BR>


<P>Subclause 6.9.2.2 [<A href="https://wg21.link/intro.races#13">intro.races</A>] paragraph 13 specifies:</P>

<BLOCKQUOTE>

A <I>visible side effect</I> A on a scalar object or bit-field M with
respect to a value computation B of M satisfies the conditions:

<UL>
<LI>A happens before B and
</LI>

<LI>there is no other side effect X to M such that A happens before X
and X happens before B.
</LI>
</UL>

The value of a non-atomic scalar object or bit-field M, as determined
by evaluation B, shall be the value stored by the visible side effect
A.

</BLOCKQUOTE>

<P>However, a side effect is defined as 6.9.1 [<A href="https://wg21.link/intro.execution#7">intro.execution</A>] paragraph 7:</P>

<BLOCKQUOTE>

Reading an object designated by a volatile glvalue
(7.2.1 [<A href="https://wg21.link/basic.lval">basic.lval</A>]), modifying an object, calling a library
I/O function, or calling a function that does any of those operations
are all <I>side effects</I>, which are changes in the state of the
execution environment.

</BLOCKQUOTE>

<P>It seems that initialization of an object is not a side effect, and
thus the value of an scalar object can never be the value obtained
during initialization.</P>

<P><B>Proposed resolution:</B></P>

<P>Change in 6.9.1 [<A href="https://wg21.link/intro.execution#7">intro.execution</A>] paragraph 7 as follows:</P>

<BLOCKQUOTE>

Reading an object designated by a volatile glvalue
(7.2.1 [<A href="https://wg21.link/basic.lval">basic.lval</A>]), modifying an object <INS>(including
initialization)</INS>, calling a library I/O function, or calling a
function that does any of those operations are all side effects, which
are changes in the state of the execution environment. ...

</BLOCKQUOTE>

<BR><BR>
</BODY>
</HTML>
