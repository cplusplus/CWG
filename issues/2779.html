<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
<TITLE>
    CWG Issue 2779</TITLE>
<STYLE TYPE="text/css">
  INS { text-decoration:none; font-weight:bold; background-color:#A0FFA0 }
  .INS { text-decoration:none; background-color:#D0FFD0 }
  DEL { text-decoration:line-through; background-color:#FFA0A0 }
  .DEL { text-decoration:line-through; background-color: #FFD0D0 }
  SPAN.cmnt { font-family:Times; font-style:italic }
</STYLE>
</HEAD>
<BODY>
<P><EM>This is an unofficial snapshot of the ISO/IEC JTC1 SC22 WG21
  Core Issues List revision 116a.
  See http://www.open-std.org/jtc1/sc22/wg21/ for the official
  list.</EM></P>
<P>2024-12-19</P>
<HR>
<A NAME="2779"></A><H4>2779.
  
Restrictions on the ordinary literal encoding
</H4>
<B>Section: </B>5.3.1&#160; [<A href="https://wg21.link/lex.charset">lex.charset</A>]
 &#160;&#160;&#160;

 <B>Status: </B>open
 &#160;&#160;&#160;

 <B>Submitter: </B>Jim X
 &#160;&#160;&#160;

 <B>Date: </B>2023-03-28<BR>


<P>There are no restrictions on the implementation's choice of
ordinary literal encoding.  However, there is an implicit assumption
that a code unit value must fit into a <TT>char</TT>.</P>

<P>Tangentially related to that, "cannot be encoded as a single code
unit" could be interpreted as referring to the values of the code
units as opposed to the fact that multiple code units might be
needed.</P>

<P><U>Possible resolution:</U></P>

<OL>
<LI>
<P>Change in 5.3.1 [<A href="https://wg21.link/lex.charset#8">lex.charset</A>] paragraph 8 as follows and add to
the index of implementation-defined behavior:</P>


<BLOCKQUOTE>

A <I>code unit</I> is an integer value of character type
(6.8.2 [<A href="https://wg21.link/basic.fundamental">basic.fundamental</A>]). Characters in a <I>character-literal</I>
other than a multicharacter <DEL>or non-encodable character</DEL>
literal or in a <I>string-literal</I> are encoded as a sequence of one
or more code units, as determined by the <I>encoding-prefix</I>
(5.13.3 [<A href="https://wg21.link/lex.ccon">lex.ccon</A>], 5.13.5 [<A href="https://wg21.link/lex.string">lex.string</A>]); this is
termed the respective <I>literal encoding</I>.  The <I>ordinary literal
encoding</I> is the
<INS>implementation-defined</INS> encoding applied to an ordinary
character or string literal<INS>; its code units are of
type <TT>unsigned char</TT></INS>.  The <I>wide literal encoding</I>
is the <INS>implementation-defined</INS> encoding applied to a wide
character or string literal<INS>; its code units are of
type <TT>wchar_t</TT></INS>.

</BLOCKQUOTE>
</LI>

<LI>
<P>Change in 5.13.3 [<A href="https://wg21.link/lex.ccon#3.1">lex.ccon</A>] bullet 3.1 as follows:</P>

<BLOCKQUOTE>

<UL>
<LI>
A <I>character-literal</I> with a <I>c-char-sequence</I> consisting of
a single <I>basic-c-char</I> , <I>simple-escape-sequence</I>,
or <I>universal-character-name</I> is the code unit value of the
specified character as encoded in the literal's associated character
encoding. If the specified character lacks representation in the
literal's associated character encoding or if it <DEL>cannot be
encoded as a single code unit</DEL> <INS>is encoded with multiple code
units</INS>, then the program is ill-formed.
</LI>
<LI>...</LI>
</UL>

</BLOCKQUOTE>

</LI>
</OL>

<BR><BR>
</BODY>
</HTML>
