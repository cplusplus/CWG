<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
<TITLE>
    CWG Issue 1884</TITLE>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<STYLE TYPE="text/css">
  INS { text-decoration:none; font-weight:bold; background-color:#A0FFA0 }
  .INS { text-decoration:none; background-color:#D0FFD0 }
  DEL { text-decoration:line-through; background-color:#FFA0A0 }
  .DEL { text-decoration:line-through; background-color: #FFD0D0 }
  @media (prefers-color-scheme: dark) {
    HTML { background-color:#202020; color:#f0f0f0; }
    A { color:#5bc0ff; }
    A:visited { color:#c6a8ff; }
    A:hover, a:focus { color:#afd7ff; }
    INS { background-color:#033a16; color:#aff5b4; }
    .INS { background-color: #033a16; }
    DEL { background-color:#67060c; color:#ffdcd7; }
    .DEL { background-color:#67060c; }
  }
  SPAN.cmnt { font-family:Times; font-style:italic }
</STYLE>
</HEAD>
<BODY>
<P><EM>This is an unofficial snapshot of the ISO/IEC JTC1 SC22 WG21
  Core Issues List revision 116c.
  See http://www.open-std.org/jtc1/sc22/wg21/ for the official
  list.</EM></P>
<P>2025-03-08</P>
<HR>
<A NAME="1884"></A><H4>1884.
  
Unclear requirements for same-named external-linkage entities
</H4>
<B>Section: </B>6.6&#160; [<A href="https://wg21.link/basic.link">basic.link</A>]
 &#160;&#160;&#160;

 <B>Status: </B>CD6
 &#160;&#160;&#160;

 <B>Submitter: </B>Richard Smith
 &#160;&#160;&#160;

 <B>Date: </B>2014-02-27<BR>


<P>[Accepted at the November, 2020 meeting as part of paper P1787R6 and
moved to DR at the February, 2021 meeting.]</P>



<P>According to 6.6 [<A href="https://wg21.link/basic.link#9">basic.link</A>] paragraph 9,</P>

<BLOCKQUOTE>

<P>Two names that are the same (6.1 [<A href="https://wg21.link/basic.pre">basic.pre</A>]) and that are
declared in different scopes shall denote the same variable, function,
type, enumerator, template or namespace if</P>

<UL>
<LI><P>both names have external linkage or else both names have
internal linkage and are declared in the same translation unit;
and</P></LI>

<LI><P>both names refer to members of the same namespace or to members, not
by inheritance, of the same class; and</P></LI>

<LI><P>when both names denote functions, the parameter-type-lists of the
functions (9.3.4.6 [<A href="https://wg21.link/dcl.fct">dcl.fct</A>]) are identical; and</P></LI>

<LI><P>when both names denote function templates, the signatures
(13.7.7.2 [<A href="https://wg21.link/temp.over.link">temp.over.link</A>]) are the same.</P></LI>

</UL>

</BLOCKQUOTE>

<P>This is not as clear as it should be.  The intent is that this
rule prevents declaring a name with extenal linkage to be, for instance,
a type in one translation unit and a namespace in a different translation
unit.  It has instead been read as begging the question of what it means
for two entities to be the same.  The wording should be tweaked to make
the intention clear.  Among other things, it should be clarified that
"declared in" refers to the namespace of which the name is a member, not
the lexical scope in which the declaration appears (which affects friend
declarations, block-scope <TT>extern</TT> declarations, and
<I>elaborated-type-specifier</I>s).</P>

<P>There is a similar restriction in _N4868_.6.4.1 [<A href="https://wg21.link/basic.scope.declarative#4">basic.scope.declarative</A>] paragraph 4
dealing with declarations within a single declarative
region, while 6.6 [<A href="https://wg21.link/basic.link#9">basic.link</A>] paragraph 9 deals with names
that are associated via linkage.  The relationship between these
complementary requirements may need to be clarified as well.</P>

<P>See also <A HREF="2165.html">issue 2165</A>.</P>

<P><B>Additional note, March, 2019:</B></P>

<P>6.6 [<A href="https://wg21.link/basic.link#11">basic.link</A>] paragraph 11 concludes by saying,</P>

<BLOCKQUOTE>

A violation of this rule on type identity does not require a diagnostic.

</BLOCKQUOTE>

<P>Presumably a diagnostic should be required if the differing types
appear within a single translation unit.</P>

<BR><BR>
</BODY>
</HTML>
