<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
<TITLE>
    CWG Issue 2694</TITLE>
<STYLE TYPE="text/css">
  INS { text-decoration:none; font-weight:bold; background-color:#A0FFA0 }
  .INS { text-decoration:none; background-color:#D0FFD0 }
  DEL { text-decoration:line-through; background-color:#FFA0A0 }
  .DEL { text-decoration:line-through; background-color: #FFD0D0 }
  SPAN.cmnt { font-family:Times; font-style:italic }
</STYLE>
</HEAD>
<BODY>
<P><EM>This is an unofficial snapshot of the ISO/IEC JTC1 SC22 WG21
  Core Issues List revision 116.
  See http://www.open-std.org/jtc1/sc22/wg21/ for the official
  list.</EM></P>
<P>2024-12-19</P>
<HR>
<A NAME="2694"></A><H4>2694.
  
<I>string-literal</I>s of the <TT>_Pragma</TT> operator
</H4>
<B>Section: </B>15.12&#160; [<A href="https://wg21.link/cpp.pragma.op">cpp.pragma.op</A>]
 &#160;&#160;&#160;

 <B>Status: </B>open
 &#160;&#160;&#160;

 <B>Submitter: </B>CWG
 &#160;&#160;&#160;

 <B>Date: </B>2023-02-07
  &#160;&#160;&#160;
  <B>Liaison: </B>WG14<BR>


<P>Subclause 15.12 [<A href="https://wg21.link/cpp.pragma.op#1">cpp.pragma.op</A>] paragraph 1 specifies:</P>

<BLOCKQUOTE>

A unary operator expression of the form:
<PRE>
      _Pragma ( <I>string-literal</I> )
</PRE>
is processed as follows: The <I>string-literal</I> is destringized by
deleting the <TT>L</TT> prefix, if present, deleting the leading and
trailing double-quotes, replacing each escape sequence <TT>\"</TT> by
a double-quote, and replacing each escape sequence <TT>\\</TT> by a
single backslash. The resulting sequence of characters is processed
through translation phase 3 to produce preprocessing tokens that are
executed as if they were the <I>pp-token</I>s in a pragma directive.
The original four preprocessing tokens in the unary operator
expression are removed.

</BLOCKQUOTE>

<P>In contrast, C23 section 6.10.6 specifies:</P>

<BLOCKQUOTE>

A unary operator expression of the form:
<PRE>
    _Pragma ( <I>string-literal</I> )
</PRE>
is processed as follows: The string literal is destringized by deleting
any encoding prefix, ...

</BLOCKQUOTE>

<P>While in C, <I>any</I> encoding prefix is deleted, C++ only deletes
the L prefix and does not consider UTF-8, UTF-16, and UTF-32 string
literals.  This was probably an oversight when C++ obtained UTF-x
string literals.</P>

<P>However, a <I>string-literal</I> entails lexing of escape sequences
and <I>universal-character-name</I>s, which seems not useful given
that the string literal is de-stringized immediately afterwards.  It
might be more appropriate to employ a simpler lexical structure such
as a <I>q-char-sequence</I> as used in a <I>header-name</I>
instead. See also <A HREF="2693.html">issue 2693</A>.</P>

<P>See also <A HREF="897.html">issue 897</A>, which is also
concerned with raw string literals and line splicing.</P>

<BR><BR>
</BODY>
</HTML>
