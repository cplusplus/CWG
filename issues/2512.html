<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
<TITLE>
    CWG Issue 2512</TITLE>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<STYLE TYPE="text/css">
  INS { text-decoration:none; font-weight:bold; background-color:#A0FFA0 }
  .INS { text-decoration:none; background-color:#D0FFD0 }
  DEL { text-decoration:line-through; background-color:#FFA0A0 }
  .DEL { text-decoration:line-through; background-color: #FFD0D0 }
  @media (prefers-color-scheme: dark) {
    HTML { background-color:#202020; color:#f0f0f0; }
    A { color:#5bc0ff; }
    A:visited { color:#c6a8ff; }
    A:hover, a:focus { color:#afd7ff; }
    INS { background-color:#033a16; color:#aff5b4; }
    .INS { background-color: #033a16; }
    DEL { background-color:#67060c; color:#ffdcd7; }
    .DEL { background-color:#67060c; }
  }
  SPAN.cmnt { font-family:Times; font-style:italic }
</STYLE>
</HEAD>
<BODY>
<P><EM>This is an unofficial snapshot of the ISO/IEC JTC1 SC22 WG21
  Core Issues List revision 116c.
  See http://www.open-std.org/jtc1/sc22/wg21/ for the official
  list.</EM></P>
<P>2025-03-08</P>
<HR>
<A NAME="2512"></A><H4>2512.
  
<TT>typeid</TT> and incomplete class types
</H4>
<B>Section: </B>7.6.1.8&#160; [<A href="https://wg21.link/expr.typeid">expr.typeid</A>]
 &#160;&#160;&#160;

 <B>Status: </B>NAD
 &#160;&#160;&#160;

 <B>Submitter: </B>Jens Maurer
 &#160;&#160;&#160;

 <B>Date: </B>2021-08-19<BR>




<P>According to 7.6.1.8 [<A href="https://wg21.link/expr.typeid">expr.typeid</A>] paragraphs 2-3,</P>

<BLOCKQUOTE>

<P>When <TT>typeid</TT> is applied to a glvalue whose type is a
polymorphic class type (11.7.3 [<A href="https://wg21.link/class.virtual">class.virtual</A>]), the
result refers to a <TT>std::type_info</TT> object
representing the type of the most derived object
(6.7.2 [<A href="https://wg21.link/intro.object">intro.object</A>]) (that is, the dynamic type) to
which the glvalue refers...</P>

<P>When <TT>typeid</TT> is applied to an expression other
than a glvalue of a polymorphic class type, the result
refers to a <TT>std::type_info</TT> object representing the
static type of the expression.</P>

</BLOCKQUOTE>

<P>The status of a glvalue of incomplete class type is not
clear from this specification. Since it is not known
whether an incomplete class type is polymorphic or not,
the existing wording could be read either as giving that
case undefined behavior or as falling into paragraph 3 and
always returning the static type.</P>

<P>The wording for <TT>dynamic_cast</TT> requires class
types to be complete, as does paragraph 4, describing
<TT>typeid</TT> applied to a <I>type-id</I>.</P>

<P><B>Rationale (December, 2021):</B></P>

<P>The change was already applied via the editorial
review process, with approval from CWG at the
2021-08-24 teleconference.</P>

<BR><BR>
</BODY>
</HTML>
