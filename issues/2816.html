<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
<TITLE>
    CWG Issue 2816</TITLE>
<STYLE TYPE="text/css">
  INS { text-decoration:none; font-weight:bold; background-color:#A0FFA0 }
  .INS { text-decoration:none; background-color:#D0FFD0 }
  DEL { text-decoration:line-through; background-color:#FFA0A0 }
  .DEL { text-decoration:line-through; background-color: #FFD0D0 }
  SPAN.cmnt { font-family:Times; font-style:italic }
</STYLE>
</HEAD>
<BODY>
<P><EM>This is an unofficial snapshot of the ISO/IEC JTC1 SC22 WG21
  Core Issues List revision 116b.
  See http://www.open-std.org/jtc1/sc22/wg21/ for the official
  list.</EM></P>
<P>2025-03-05</P>
<HR>
<A NAME="2816"></A><H4>2816.
  
Unclear phrasing "may assume ... eventually"
</H4>
<B>Section: </B>6.9.2.3&#160; [<A href="https://wg21.link/intro.progress">intro.progress</A>]
 &#160;&#160;&#160;

 <B>Status: </B>review
 &#160;&#160;&#160;

 <B>Submitter: </B>Jiang An
 &#160;&#160;&#160;

 <B>Date: </B>2023-04-26<BR>


<P>Subclause 6.9.2.3 [<A href="https://wg21.link/intro.progress#1">intro.progress</A>] paragraph 1 specifies:</P>

<BLOCKQUOTE>

The implementation may assume that any thread will eventually do one
of the following:
<UL>
<LI>terminate,</LI>
<LI>make a call to a library I/O function,</LI>
<LI>perform an access through a volatile glvalue, or</LI>
<LI>perform a synchronization operation or an atomic operation.</LI>
</UL>

</BLOCKQUOTE>

<P>This formulation has two issues.  First, what are the consequences
of the user violation the assumption?  It should be clearly specified
that undefined behavior results.  Second, what does "eventually" mean?
The wording gives the impression that the requirement is satisfied if
a thread performs some I/O operation at its beginning and then goes
into an empty infinite loop.</P>

<P>It was also noted that that 6.9.2.3 [<A href="https://wg21.link/intro.progress#3">intro.progress</A>] paragraph 3
is a near-duplicate of paragraph 1.</P>

<P><U>Possible resolution:</U></P>

<OL>
<LI>
<P>Remove 6.9.2.3 [<A href="https://wg21.link/intro.progress#1">intro.progress</A>] paragraph 1:</P>

<BLOCKQUOTE class="del">

The implementation may assume that any thread will eventually do one
of the following:

<UL>
<LI>terminate,</LI>
<LI>make a call to a library I/O function,</LI>
<LI>perform an access through a volatile glvalue, or</LI>
<LI>perform a synchronization operation or an atomic operation.</LI>
</UL>

[<I>Note 1:</I> This is intended to allow compiler transformations
such as removal of empty loops, even when termination cannot be
proven. &#8212;<I>end note</I>]

</BLOCKQUOTE>
</LI>

<LI>
<P>Change in 6.9.2.3 [<A href="https://wg21.link/intro.progress#5">intro.progress</A>] paragraph 5 as follows:</P>

<BLOCKQUOTE>

<INS>The behavior is undefined if a thread of execution that has not
terminated stops making execution steps.</INS>

[<I>Note:</I> <INS>This is intended to allow compiler transformations
such as removal of empty loops, even when termination cannot be
proven.</INS> <DEL>Because of this and the preceding requirement
regarding what threads of execution have to perform eventually,
it</DEL> <INS>It</INS> follows that no thread of execution can execute
forever without an execution step occurring. &#8212;<I>end note</I>]

</BLOCKQUOTE>
</LI>
</OL>

<BR><BR>
</BODY>
</HTML>
