<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
<TITLE>
    CWG Issue 2860</TITLE>
<STYLE TYPE="text/css">
  INS { text-decoration:none; font-weight:bold; background-color:#A0FFA0 }
  .INS { text-decoration:none; background-color:#D0FFD0 }
  DEL { text-decoration:line-through; background-color:#FFA0A0 }
  .DEL { text-decoration:line-through; background-color: #FFD0D0 }
  SPAN.cmnt { font-family:Times; font-style:italic }
</STYLE>
</HEAD>
<BODY>
<P><EM>This is an unofficial snapshot of the ISO/IEC JTC1 SC22 WG21
  Core Issues List revision 116.
  See http://www.open-std.org/jtc1/sc22/wg21/ for the official
  list.</EM></P>
<P>2024-12-19</P>
<HR>
<A NAME="2860"></A><H4>2860.
  
Remove and fix the term "vacuous initialization"
</H4>
<B>Section: </B>6.7.4&#160; [<A href="https://wg21.link/basic.life">basic.life</A>]
 &#160;&#160;&#160;

 <B>Status: </B>dup
 &#160;&#160;&#160;

 <B>Submitter: </B>Jiang An
 &#160;&#160;&#160;

 <B>Date: </B>2024-02-21<BR>


<P>(From submission
<A HREF="https://github.com/cplusplus/CWG/issues/505">#505</A>.)</P>

<P>A class may have a trivial default constructor that is not actually
used to default-initialize a class object, e.g. because the
constructor is not eligible.  The definition of "vacuous initialization"
in 6.7.4 [<A href="https://wg21.link/basic.life#1">basic.life</A>] paragraph 1, as used in
8.8 [<A href="https://wg21.link/stmt.dcl#2">stmt.dcl</A>] paragraph 2, does not reflect that fact.</P>

<P><U>Possible resolution:</U></P>

<OL>
<LI>
<P>Change in 6.7.4 [<A href="https://wg21.link/basic.life#1">basic.life</A>] paragraph 1 as follows:</P>

<BLOCKQUOTE>

The lifetime of an object or reference is a runtime property of the
object or reference. <DEL>A variable is said to have <I>vacuous
initialization</I> if it is default-initialized and, if it is of class
type or a (possibly multidimensional) array thereof, that class type
has a trivial default constructor.</DEL> The lifetime of an object of
type T begins when:
<UL>
<LI>storage with the proper alignment and size for type T is obtained,
and</LI>
<LI>its initialization (if any) is complete <DEL>(including vacuous
initialization)</DEL> (9.4 [<A href="https://wg21.link/dcl.init">dcl.init</A>]),</LI>
</UL>
except that if the object is a union member or subobject thereof, its
lifetime only begins if that union member is the initialized member in
the union (9.4.2 [<A href="https://wg21.link/dcl.init.aggr">dcl.init.aggr</A>], 11.9.3 [<A href="https://wg21.link/class.base.init">class.base.init</A>]),
or as described in 11.5 [<A href="https://wg21.link/class.union">class.union</A>],
11.4.5.3 [<A href="https://wg21.link/class.copy.ctor">class.copy.ctor</A>], and 11.4.6 [<A href="https://wg21.link/class.copy.assign">class.copy.assign</A>], and
except as described in 20.2.10.2 [<A href="https://wg21.link/allocator.members">allocator.members</A>]. ...

</BLOCKQUOTE>
</LI>

<LI>
<P>Change in 8.8 [<A href="https://wg21.link/stmt.dcl#2">stmt.dcl</A>] paragraph 2 as follows:</P>

<BLOCKQUOTE>

A variable with automatic storage duration
(6.7.6.4 [<A href="https://wg21.link/basic.stc.auto">basic.stc.auto</A>]) is active everywhere in the scope to
which it belongs after its <I>init-declarator</I> . Upon each transfer
of control (including sequential execution of statements) within a
function from point P to point Q, all variables with automatic storage
duration that are active at P and not at Q are destroyed in the
reverse order of their construction. Then, all variables with
automatic storage duration that are active at Q but not at P are
initialized in declaration order; unless all such variables <DEL>have
vacuous initialization (6.7.4 [<A href="https://wg21.link/basic.life">basic.life</A>])</DEL>
<INS>are default-initialized and no initialization is performed for
any such variable other than calling a trivial default
constructor</INS>, the transfer of control shall not be a jump. [
Footnote: ... ] When a <I>declaration-statement</I> is executed, P and
Q are the points immediately before and after it; when a function
returns, Q is after its body. ...

</BLOCKQUOTE>
</LI>
</OL>

<P><B>CWG 2024-04-05</B></P>

<P>CWG preferred to keep the term <I>vacuous initialization</I> and
fix its definition while adressing <A HREF="2859.html">issue 2859</A>.</P>

<BR><BR>
</BODY>
</HTML>
