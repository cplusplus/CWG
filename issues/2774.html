<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
<TITLE>
    CWG Issue 2774</TITLE>
<STYLE TYPE="text/css">
  INS { text-decoration:none; font-weight:bold; background-color:#A0FFA0 }
  .INS { text-decoration:none; background-color:#D0FFD0 }
  DEL { text-decoration:line-through; background-color:#FFA0A0 }
  .DEL { text-decoration:line-through; background-color: #FFD0D0 }
  SPAN.cmnt { font-family:Times; font-style:italic }
</STYLE>
</HEAD>
<BODY>
<P><EM>This is an unofficial snapshot of the ISO/IEC JTC1 SC22 WG21
  Core Issues List revision 116.
  See http://www.open-std.org/jtc1/sc22/wg21/ for the official
  list.</EM></P>
<P>2024-12-19</P>
<HR>
<A NAME="2774"></A><H4>2774.
  
Value-dependence of <I>requires-expression</I>s
</H4>
<B>Section: </B>13.8.3.4&#160; [<A href="https://wg21.link/temp.dep.constexpr">temp.dep.constexpr</A>]
 &#160;&#160;&#160;

 <B>Status: </B>open
 &#160;&#160;&#160;

 <B>Submitter: </B>Christof Meerwald
 &#160;&#160;&#160;

 <B>Date: </B>2023-07-17<BR>




<P>Consider:</P>

<PRE>
   template&lt;typename T&gt;
   struct A
   {
     static_assert(sizeof(T) == 3);    // <SPAN CLASS="cmnt">#1</SPAN>
   };

   template&lt;bool B&gt;
   struct C
   {
     static_assert(B);                 // <SPAN CLASS="cmnt">#2</SPAN>
   };

   template&lt;typename T, typename U&gt;
   int f(typename C&lt;requires { typename T::type; }&gt;::type, typename A&lt;T&gt;::type, U);

   int i = f&lt;char&gt;(0, 1, 2);
</PRE>

<P>Is the <I>requires-expression</I> value-dependent after
substituting the explicit template argument, thus failing at #2
instead of at #1?</P>

<P><U>Suggested resolution:</U></P>

<OL>
<LI>
<P>Change in 13.8.3.3 [<A href="https://wg21.link/temp.dep.expr#4">temp.dep.expr</A>] paragraph 4 as follows:</P>

<BLOCKQUOTE>

Expressions of the following forms are never type-dependent (because
the type of the expression cannot be dependent):

<PRE>
  ...
  noexcept ( <I>expression</I> )
  <INS><I>requires-expression</I></INS>
</PRE>

</BLOCKQUOTE>

</LI>

<LI>
<P>Insert a new paragraph before 13.8.3.4 [<A href="https://wg21.link/temp.dep.constexpr#5">temp.dep.constexpr</A>] paragraph 5:</P>

<BLOCKQUOTE>

<P class="ins">
A <I>requires-expression</I> is value-dependent if it depends on a
template parameter.
</P>

<P>An expression of the form &amp;<I>qualified-id</I> where
the <I>qualified-id</I> names a dependent member ...</P>

</BLOCKQUOTE>
</LI>
</OL>

<P><B>CWG 2023-08-25</B></P>

<P>The first change has consensus and is progressed via
<A HREF="2785.html">issue 2785</A>; the second change should use an
approach of recursive decomposition for <I>requires-expression</I>,
similar to other paragraphs in 13.8.3.4 [<A href="https://wg21.link/temp.dep.constexpr">temp.dep.constexpr</A>].  The
implementation divergence is believed to be an independent bug in one
implementation.</P>

<BR><BR>
</BODY>
</HTML>
